<% if @match.status == 0 %>
  <h1>対戦相手探し中...</h1>
<% elsif @match.status == 1 && @game.end_at %>
  <h1>対戦相手の回答待ち...</h1>
<% elsif @match.status == 1 && @opponent_game %>
  <div class="row">
    <div class="col s12 m8 l6 offset-m2 offset-l3 question-container">
      <div id="judgment" class="question-judgment"></div>
      <div class="z-depth-1 question-image">
      <% if @question.images.attached? %>
        <% @question.images.each_with_index do |image, i| %>
          <%= image_tag image.variant(:display).processed,
                        id: "question-image-#{i}",
                        class: "#{i == 0 ? 'active' : ''}" %>
        <% end %>
      <% end %>
      </div>
      <p>Q.<%= session[:question_num] %> / <%= Game.find(params[:game_id]).question_quantities %>問中</p>
  
        <%= form_with scope: :question,
                      url: match_update_path(params[:match_id], params[:game_id]),
                      method: :patch,
                      html: {name: "myform"} do |f| %>
          <% @choices.each do |choice| %>
            <div>
              <label>
                <%= f.radio_button :choice, choice[:is_correct], class: "with-gap" %>
                <div class="waves-effect waves-light btn full mb-1">
                  <%= choice[:text] %>
                </div>
              </label>
            </div>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
<% elsif @match.status == 2 %>
  <div class="row">
    <div class="result-card col s12 m8 l6 offset-m2 offset-l3 z-depth-1 center-align">
      <p><span class="bold"><%= @game.name %></span>さんの結果は...</p>
      <p class="result-text">正解率: <%= @game.correct_answers %> (<%= @game.percentage_correct_answers %>%)</p>
      <%= link_to "Top画面へ戻る", root_path, class: "waves-effect waves-light btn-large" %>
    </div>
    <div class="result-card col s12 m8 l6 offset-m2 offset-l3 z-depth-1 center-align">
      <p><span class="bold"><%= @opponent_game.name %></span>さんの結果は...</p>
      <p class="result-text">正解率: <%= @opponent_game.correct_answers %> (<%= @opponent_game.percentage_correct_answers %>%)</p>
    </div>
  </div>
<% end %>

<p><%= "@match.id: #{ @match.id }" %></p>
<p><%= "@game.id: #{ @game.id }" %></p>
<p><%= "@opponent_game.id: #{ @opponent_game ? @opponent_game.id : 'なし' }" %></p>